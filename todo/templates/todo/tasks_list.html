{% extends 'base.html' %} {% load static %} {% block title %}FluToDo{% endblock %}
{% block content%}
<a href="{% url 'logout' %}">Logout</a>

    

<div class="tableFormWrapper">
  <form class="" id="createTaskForm" method="POST"  >
    {% csrf_token %}
    <label for="taskName">Add Task:</label>
    <input type="text" id="taskName" name="taskName" >
    <input type="submit" value="Submit">

  </form>
</div>

<table class="styled-table">
    <tr>
      <th>Name</th>
      <th>IsComplete</th>
      <th>Change State</th>
      <th>Delete</th>
    </tr>
    {%for task in tasks_list%}
    <tr >
        <td  >{{task.task_name}}</td>
        <td  >{% if task.is_completed %}<img id="isCompleteCell" src="/static/admin/img/icon-yes.svg" alt="True"> </i>{%else%} <img id="isCompleteCell" src="/static/admin/img/icon-no.svg" alt="False"> {%endif%}
        </td>  
        <td>
          <div class="tableFormWrapper">
            <form id="form_{{task.id}}" method="POST">
              {% csrf_token %}
              <label class="switch">
                
                  <input type='hidden' value='{{task.pk}}' name='id'>
                  <input id="{{task.id}}" name="input" type="checkbox" value={{task.is_completed}} onchange="toggleState(this)">
                  <span class="slider round"></span>
          
              </label>
            </form>
          </div>
          
         
        </td>
     
        <td >
          <div class="tableFormWrapper">
            <form class="deleteForm" id="form_{{task.id}}" method="GET" action="{% url 'delete' pk=task.pk %}" >
              {% csrf_token %}
              <input id="deleteIcon" type="image" name="submit" src="/static/delete.svg"> 
            </form>
          </div>
        </td>
      </tr> 
   
    {%empty%}
    <span>No tasks to complete</span>
    {%endfor%}
    
    
  </table>

<script type="text/javascript">  
   function toggleState(item){
        document.getElementById(`form_${item.id}`).submit();
   }
        
</script>
{% endblock %}